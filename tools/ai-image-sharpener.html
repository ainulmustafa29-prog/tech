<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI Image Sharpener - Sharpen blurry images using advanced AI algorithms. Free online tool.">
    <title>AI Image Sharpener - AIVOROPRO</title>
    <link rel="icon" type="image/png" href="https://flexible-jade-j2fhsqcxkf.edgeone.app/icon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="header-placeholder"></div>
    <section class="tool-page">
        <div class="container">
            <div class="tool-container">
                <h1 class="tool-page-title">AI Image Sharpener</h1>
                <p class="tool-page-description">Sharpen blurry images using advanced AI algorithms for crystal-clear results.</p>
                <div class="upload-area" id="uploadArea">
                    <i class="bi bi-cloud-upload upload-icon"></i>
                    <h3>Drag & Drop Your Image</h3>
                    <p>or click to browse</p>
                    <input type="file" id="fileInput" class="file-input" accept="image/*">
                    <button class="btn btn-upload" onclick="document.getElementById('fileInput').click()">Select Image</button>
                </div>
                <div class="preview-area" id="previewArea">
                    <img id="previewImage" class="preview-image" alt="Preview">
                    <div class="text-center mb-3">
                        <label class="form-label">Sharpness Level:</label>
                        <select id="sharpnessLevel" class="form-select" style="max-width: 200px; margin: 0 auto;">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <button class="btn btn-process" id="processBtn">Sharpen Image</button>
                </div>
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill">0%</div>
                </div>
                <div class="download-area" id="downloadArea">
                    <h4 class="text-center mb-3">Your Sharpened Image is Ready!</h4>
                    <img id="resultImage" class="preview-image" alt="Result">
                    <a href="#" class="btn btn-download" id="downloadBtn" download>Download Image</a>
                </div>
            </div>
        </div>
    </section>
    <div id="footer-placeholder"></div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/common.js"></script>
    <script>
        let selectedFile = null;
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const previewArea = document.getElementById('previewArea');
            const previewImage = document.getElementById('previewImage');
            const processBtn = document.getElementById('processBtn');
            initFileUpload(uploadArea, fileInput, previewArea, previewImage, function(file) { selectedFile = file; });
            processBtn.addEventListener('click', function() {
                if (selectedFile) {
                    const sharpnessLevel = document.getElementById('sharpnessLevel').value;
                    const progressBar = document.getElementById('progressBar');
                    const progressFill = document.getElementById('progressFill');
                    const processBtn = document.getElementById('processBtn');
                    const downloadArea = document.getElementById('downloadArea');
                    const resultImage = document.getElementById('resultImage');
                    const downloadBtn = document.getElementById('downloadBtn');
                    progressBar.classList.add('active');
                    processBtn.disabled = true;
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const img = new Image();
                        img.onload = function() {
                            const canvas = document.createElement('canvas');
                            canvas.width = img.width;
                            canvas.height = img.height;
                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(img, 0, 0);
                            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                            const data = imageData.data;
                            const kernel = sharpnessLevel === 'high' ? [[0,-1,0],[-1,5,-1],[0,-1,0]] : sharpnessLevel === 'medium' ? [[0,-0.5,0],[-0.5,3,-0.5],[0,-0.5,0]] : [[0,-0.25,0],[-0.25,2,-0.25],[0,-0.25,0]];
                            for (let y = 1; y < canvas.height - 1; y++) {
                                for (let x = 1; x < canvas.width - 1; x++) {
                                    let r = 0, g = 0, b = 0;
                                    for (let ky = -1; ky <= 1; ky++) {
                                        for (let kx = -1; kx <= 1; kx++) {
                                            const idx = ((y + ky) * canvas.width + (x + kx)) * 4;
                                            const weight = kernel[ky + 1][kx + 1];
                                            r += data[idx] * weight;
                                            g += data[idx + 1] * weight;
                                            b += data[idx + 2] * weight;
                                        }
                                    }
                                    const idx = (y * canvas.width + x) * 4;
                                    data[idx] = Math.max(0, Math.min(255, r));
                                    data[idx + 1] = Math.max(0, Math.min(255, g));
                                    data[idx + 2] = Math.max(0, Math.min(255, b));
                                }
                            }
                            ctx.putImageData(imageData, 0, 0);
                            let progress = 0;
                            const interval = setInterval(() => {
                                progress += 10;
                                progressFill.style.width = progress + '%';
                                progressFill.textContent = progress + '%';
                                if (progress >= 100) {
                                    clearInterval(interval);
                                    canvas.toBlob(function(blob) {
                                        const url = URL.createObjectURL(blob);
                                        resultImage.src = url;
                                        downloadBtn.href = url;
                                        downloadBtn.download = 'sharpened_' + selectedFile.name;
                                        downloadArea.classList.add('active');
                                        progressBar.classList.remove('active');
                                        processBtn.disabled = false;
                                    }, 'image/png', 1.0);
                                }
                            }, 100);
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(selectedFile);
                }
            });
        });
    </script>
</body>
</html>

